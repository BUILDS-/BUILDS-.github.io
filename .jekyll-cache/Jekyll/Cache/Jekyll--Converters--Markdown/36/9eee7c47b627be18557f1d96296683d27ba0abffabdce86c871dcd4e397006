I"F<p>Portal is a screen in the ceiling that shows the contents of the door camera in ASCII art.</p>

<h3 id="documentation">Documentation</h3>

<p>The hostname of the laptop is: builds-portal, and it’s IP address is 128.197.15.38.</p>

<p>The portal is running Debian 6.0.3.</p>

<p>Startup sequence: There is no startup sequence.</p>

<h3 id="todo">TODO</h3>

<ul>
  <li>Potentially reduce latency further.</li>
  <li>Laptop screen dims after a while?</li>
</ul>

<h3 id="changelog">Changelog</h3>

<ul>
  <li>3/31: Added new info about how to add new portals to the multiplexer.</li>
  <li>2/20: Changed method of streaming to use mpeg4 compressed video over raw udp. Decoding is now done on the laptop. Upon startup, rc.local runs the script /home/builds/portal.sh as root, which runs a vlc command that listens on udp port 5004 for incoming video. On the door, the following command must be run to start the video:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nice cvlc -I dummy -A dummy -V dummy v4l2:///dev/video0 --sout \
"#transcode{vcodec=mpeg4,width=640,height=480,vb=200,acodec=none}:std{mux=ts,dst=128.197.15.38:5004,access=udp}" \
--v4l2-caching=100 --sout-udp-caching=0
</code></pre></div></div>

<ul>
  <li>2/20: Updated /etc/rc.local to automatically ssh into the door and connect to a screen to view VLC. Retries every 60 seconds.</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>su -c "while true; do ssh -t -C door@thingone.furstlabs.com 'screen -r portal; exit'; sleep 60; done;" builds
</code></pre></div></div>

<ul>
  <li>2/20: Updated /etc/default/grub to include “vga=791” and “consoleblank=0”. This sets the proper TTY resolution and disable consoleblank timeout (aka TTY will always be on).</li>
  <li>2/19: Initial Installation.</li>
</ul>

<h3 id="artwork">Artwork</h3>

<p>Portal artwork by Anthony Inzero.</p>

<h3 id="to-create-new-ones-updated-3312012">TO CREATE NEW ONES (updated 3/31/2012)</h3>

<p>To create a new portal, install debian with base utils and sshd. Then install vlc, xorg, and sudo. Add builds to the sudo group. change the following files: /etc/X11/Xwrapper.config:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>allowedusers=anybody
</code></pre></div></div>

<p>/etc/rc.local:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo -u builds startx &amp;
</code></pre></div></div>

<p>~/.xinitrc:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>WIDTH=400
HEIGHT=250
FPS=18
PORT=!!!INSERT PORT HERE!!!
TARGET=128.197.15.44

nice cvlc -vv v4l2:///dev/video0 --sout \
"#transcode{vcodec=mp1v,width=$WIDTH,height=$HEIGHT,acodec=none}:\
rtp{dst=$TARGET,port=$PORT}" \
--v4l2-caching=60 -V dummy -I dummy -A dummy \
--v4l2-width=$WIDTH --v4l2-height=$HEIGHT --v4l2-fps=$FPS \
--sout-transcode-threads=2 --sout-rtp-caching=0 &amp;

xset -dpms s off

nice vlc -A dummy -V xvideo --no-video-title-show \
--fullscreen --rtp-caching=100 rtp://@:$PORT
</code></pre></div></div>
:ET